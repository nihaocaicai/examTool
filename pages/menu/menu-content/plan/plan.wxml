<view wx:if="{{!loading}}">
  <scroll-view wx:if="{{showView}}" scroll-y="true" style="width: 100%; height: 100%;">
    <view wx:for="{{totalPlan}}" wx:key='{{index}}' wx:for-item="month">
      <view style="display:flex; width: 100%;">
        <!-- 不同月份颜色不同，颜色数目不定 -->
        <view style="width:5%; background:{{color[index%color.length]}}" />
        <view style="width:95%;">
          <!-- 月份标题 -->
          <view class='date'>{{month.date}}</view>
          <!-- 当前月份下的日期 -->
          <i-collapse>
            <i-collapse-item wx:for="{{month['data']}}" wx:for-item="plans" wx:key='{{index}}' title="{{month.date + plans.day}}" name="{{month.date + plans.day}}">
              <!-- 当前日期下的所有计划 -->
              <view slot="content">
                <view wx:for="{{plans.plan}}" wx:for-item="detail" wx:key='{{index}}'>
                  <view class='detail'>
                    <view class='time'>{{detail.time}}</view>
                    <view class='content'>{{detail.content}}</view>
                  </view>
                </view>
              </view>
            </i-collapse-item>
          </i-collapse>
        </view>
      </view>
    </view>

    <view wx:if='{{hasMorePlan}}' id="tips" bindtap='loadMore'>点我加载更多计划</view>
    <view wx:else id="tips">没有更多了</view>
  </scroll-view>

  <view wx:if="{{loadingFail}}" class='tips'>
    <view style='margin-bottom:1vh'>
      哎呀，历史计划获取失败了
    </view>
    <button class='button' bindtap='_initData'>再试试</button>
  </view>

  <view wx:if="{{noPlan}}" class='tips'>
    <view style='margin-bottom:1vh'>你还没有任何计划哦</view>
    <view>赶快去首页添加计划吧</view>
  </view>
</view>